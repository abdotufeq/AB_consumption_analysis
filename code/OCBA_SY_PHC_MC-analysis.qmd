---
title: Antibiotics in PHCs & MCs<br>OCBA - SYRIA Mission
subtitle: "Analyzing supplies of antibiotics from June to December 2023 against the data extracted from HMIS"
date: "15, May 2023"
#author: "Dr. Zyad Ejjilat<br>Abdullah Almohammed"
format: 
  revealjs:
    auto-stretch: false
    preview-links: true
    slide-number: true
    logo: ..\images\Doctorswithoutborders.jpg
    footer: "Syria Mission's PHC and MC Antibiotics analysis"
    css: styles.css
    navigation-mode: vertical
    controls: true
    controls-layout: bottom-right
    controls-tutorial: true 
    touch: true
    institute: "MSF - OCBA - SYRIA Mission"
    output-file: "OCBA_SY_PHC_MC_AB_presentation"
    fig-align: center
    fig-width: 10
    fig-height: 6 
    transition: slide
    background-transition: fade
    #scrollable: true
  
embed-resources: true
---

# Context

::: incremental
1.  Armed conflict with lots of displacements
2.  Working through partnership of DoH and local NGOs (MSF is NOT the direct implementer of services).
3.  Two projects: IDAL and NAP
4.  Supporting PHCs, MCs, BEmONCs and CEmONCs
5.  Regular monthly medical donations based on the facilities consumption
6.  AMR and Antibiotics over-prescribing are quiet spread in Syria
:::

# objectives

::: incremental
1.  Evaluate the antibiotic usage:\
    is there Antibiotics over-prescribing in Facilities? where? how much? how often?
2.  Evaluate the rational prescribing behavior:\
    are first line of ABs prescribed (Access group) or skipped to second line (Watch group) immediately?
3.  Double check the balance between antipyretic courses and antibiotics courses?
:::

# Data resources

::: incremental
-   Monthly donations extracted from Isystock (it is based on the facilities monthly consumption)
-   Export HMIS data for all health facilities (HF) for concerned period.
-   **Age**:
    -   Under 5 years U5.
    -   5 years or more O5.
-   **consultation categories**:
    -   Total consultations.
:::

# Parameters

::: incremental
1.  define the Antibiotics list in the mission and its category based on WHO AWaRE categorization [(Access, Watch)](https://aware.essentialmeds.org/list)
2.  define Age categories of those medications:
    -   Under 5 years U5 (pediatrics: Suspension, Syrups, dispersible tablets and pediatrics injectables
    -   5 years or more O5: Tablets and injectables for adult
:::

## 

::: incremental
3.  Define the Duration of treatment based on MSF[^1] (the average duration of treatment of the main indication of the drug)
4.  [WHO DDD](https://www.whocc.no/atc_ddd_index/): Daily defined dose is the assumed average maintenance dose (grams) per day for a drug used for its main indication in adults.
5.  Calculation of number of units of medication per course
    -   Under 5 years U5:\
        each bottle of suspension or syrup are 1 course.
:::

[^1]: from both Clinical guidelines and Essential Medicines

## 

::: incremental
-   5 years or more O5:\
    DDD \* DoT / (dose of medication per unit in grams) Amoxicillin 500 mg =\>\
    DDD is 1.5 gram =\> duration of treatment is between 5 to 7 days =\>\
    7 (duration of treatment)\* 1.5 (DDD)/ 0.5 (dose of medicine per unit in grams) = 21 tablets\
    Amoxicillin 500mgcourse is 21 tablets.\
:::

## Access group antibiotics

```{r}
#| include: false

library(tidyverse)
library(plotly)
library(purrr)
library(glue)
library(lubridate)
library(kableExtra)
library(here)
library(xlsx)

access_lst <-
read.xlsx(
  here("std/antibiotics.xlsx"),
  sheetName = "PHC"
) %>%
mutate(
  Age = if_else(is_it_more_than_5== "TRUE", "5 years or more", "Under 5 years"),
  unit_per_course = rounded_course
) %>%
select(
  Code, Article, DDD, U, AWaRe, Age, unit_per_course
) %>%
filter(
  AWaRe == "Access"
)
watch_lst <-
read.xlsx(
  here("std/antibiotics.xlsx"),
  sheetName = "PHC"
) %>%
mutate(
  Age = if_else(is_it_more_than_5== "TRUE", "5 years or more", "Under 5 years"),
  unit_per_course = rounded_course
) %>%
select(
  Code, Article, DDD, U, AWaRe, Age, unit_per_course
) %>%
filter(
  AWaRe == "Watch"
)

```

```{r}
access_lst %>% kbl() %>%
 kable_styling(
   bootstrap_options = c("striped", "hover", "condensed"),
   font_size = 15,
   html_font = "Cambria"
     )
```

## Watch group antibiotics

```{r}
watch_lst %>% kbl() %>%
 kable_styling(bootstrap_options = c("striped", "hover", "condensed"),
               font_size = 16,
               html_font = "Cambria")
```

# Access vs Watch AB

BEmONCs and CEmONCs included

```{r}
#| include: false
source(here("code/04_read_Mission_processed_data.R"))
source(here("code/05_Abdullahlib.R"))

sy_course_isy <-
  sy_course_isy %>% 
  filter(
    unite_dest != "Mental Health Activity" &
      unite_dest != "INH CCTC"
    ) 

HFs <- unique(sy_course_isy$unite_dest)



    
adult <- 
  HFs %>%
    map(
      .f = plot_access_watch,
      df = sy_course_isy,
      age_cat = TRUE
      )
paed <- 
   HFs %>%
    map(
      .f = plot_access_watch,
      df = sy_course_isy,
      age_cat = FALSE
      )

```

## 

```{r}
#| fig-cap: "Mission's ratio of Access to Watch - **5 years or more**"



mission_plot_access_watch(sy_course_isy, TRUE)%>%
  layout(
    legend = list(
      x= 0.7,
      y= 1.05,
      xanchor='center',
      yanchor='top',
      bgcolor= 'rgba(0,0,0,0)',
      bordercolor = I("black"),
      borderwidth = 1,
      orientation = 'h',
      font=list(
        size=10, color=I("black")
        )
      )
    )

```

## 

```{r}
#| fig-cap: "Mission's ratio of Access to Watch - **Under 5 years**"

mission_plot_access_watch(sy_course_isy, FALSE) %>% 
  layout(
    legend = list(
      x= 0.7,
      y= 1.1,
      xanchor='center',
      yanchor='top',
      bgcolor= 'rgba(0,0,0,0)',
      bordercolor = I("black"),
      borderwidth = 1,
      orientation = 'h',
      font=list(
        size=10, color=I("black")
        )
      )
    )
```

## 

```{r}
#| fig-cap: "good ratio (within target)"

adult[[16]] %>%
  layout(
    legend = list(
      x= 0.6,
      y=0.95,
      xanchor='center',
      yanchor='top',
      bgcolor= 'rgba(0,0,0,0)',
      bordercolor = I("black"),
      borderwidth = 1,
      orientation = 'h',
      font=list(
        size=15, color=I("black")
        )
      )
    )
```

## 

```{r}
#| fig-cap: "good ratio" 


paed[[16]] %>% 
  layout(
    legend = list(
      x= 0.6,
      y=0.95,
      xanchor='center',
      yanchor='top',
      bgcolor= 'rgba(0,0,0,0)',
      bordercolor = I("black"),
      borderwidth = 1,
      orientation = 'h',
      font=list(
        size=15, color=I("black")
        )
      )
    )
```

## 

```{r}
#| fig-cap: "tendency to prescribe more Watch (second lines)"

adult[[3]] %>%  
  layout(
    legend = list(
      x= 0.6,
      y=0.95,
      xanchor='center',
      yanchor='top',
      bgcolor= 'rgba(0,0,0,0)',
      bordercolor = I("black"),
      borderwidth = 1,
      orientation = 'h',
      font=list(
        size=15, color=I("black")
        )
      )
    )
```

## 

```{r}
#| fig-cap: "higher tendency to preiscribe Watch"

paed[[17]] %>% 
  layout(
    legend = list(
      x= 0.6,
      y=0.95,
      xanchor='center',
      yanchor='top',
      bgcolor= 'rgba(0,0,0,0)',
      bordercolor = I("black"),
      borderwidth = 1,
      orientation = 'h',
      font=list(
        size=15, color=I("black")
        )
      )
    )
```

# Percentage of AB prescription to consultation

PHCs and MCs only

```{r}
#| include: false


xx <-
  sy_course_isy %>% 
  inner_join(
    .,
    hmis,
    by = c("unite_dest" = "unit")
    ) 

HF <- unique(xx$unite_dest) 
remove(xx)

ab_cns_adlt <- 
  HF %>%
    map(
      .f = plot_AB_consult,
      df_isy = sy_course_isy,
      df_hmis = hmis,
      age_cat = TRUE
      )
ab_cns_pd <- 
   HF %>%
    map(
      .f = plot_AB_consult,
      df_isy = sy_course_isy,
      df_hmis = hmis,
      age_cat = FALSE
      )

```

## 

```{r}
#| fig-cap: "Mission's Percentage of Antibiotics & Antipyrretics to consultations - **5 years or more**"

mission_plot_AB_consult(sy_course_isy,hmis, TRUE) %>% 
  layout(
    legend = list(
      x= 0.7,
      y= 1.1,
      xanchor='center',
      yanchor='top',
      bgcolor= 'rgba(0,0,0,0)',
      bordercolor = I("black"),
      borderwidth = 1,
      orientation = 'h',
      font=list(
        size=10, color=I("black")
        )
      )
    )
```

## 

```{r}
#| fig-cap: "Mission's Percentage of Antibiotics & Antipyrretics to consultations - **Under 5 years**"


mission_plot_AB_consult(sy_course_isy,hmis, FALSE) %>% 
  layout(
    legend = list(
      x= 0.7,
      y= 1.1,
      xanchor='center',
      yanchor='top',
      bgcolor= 'rgba(0,0,0,0)',
      bordercolor = I("black"),
      borderwidth = 1,
      orientation = 'h',
      font=list(
        size=10, color=I("black")
        )
      )
    )
```

## 

```{r}
#| fig-cap: "good ratio"

ab_cns_adlt[[2]] %>% 
  layout(
    legend = list(
      x= 0.6,
      y= 1,
      xanchor='center',
      yanchor='top',
      bgcolor= 'rgba(0,0,0,0)',
      bordercolor = I("black"),
      borderwidth = 1,
      orientation = 'h',
      font=list(
        size=10, color=I("black")
        )
      )
    )
```

## 

```{r}
#| fig-cap: "good ratio"

ab_cns_pd[[3]] %>% 
  layout(
    legend = list(
      x= 0.6,
      y= 1,
      xanchor='center',
      yanchor='top',
      bgcolor= 'rgba(0,0,0,0)',
      bordercolor = I("black"),
      borderwidth = 1,
      orientation = 'h',
      font=list(
        size=10, color=I("black")
        )
      )
    )
```

## 

```{r}
#| fig-cap: "abnormal ratio - needs investigation"

ab_cns_adlt[[10]] %>% 
  layout(
    legend = list(
      x= 0.6,
      y= 1,
      xanchor='center',
      yanchor='top',
      bgcolor= 'rgba(0,0,0,0)',
      bordercolor = I("black"),
      borderwidth = 1,
      orientation = 'h',
      font=list(
        size=10, color=I("black")
        )
      )
    )
```

## 

```{r}
#| fig-cap: "Abnoraml ratio - needs invistigations"

ab_cns_pd[[10]] %>% 
  layout(
    legend = list(
      x= 0.6,
      y= 1.1,
      xanchor='center',
      yanchor='top',
      bgcolor= 'rgba(0,0,0,0)',
      bordercolor = I("black"),
      borderwidth = 1,
      orientation = 'h',
      font=list(
        size=10, color=I("black")
        )
      )
    )

```

# Observation & Recommendations

## Observations:

::: incremental
1.  In general, there is a high rate of antibiotics consumption, this is even higher in **mobile activities and pediatric consultations**.
2.  In some facilities, the number of Abx courses delivered is higher than the number of consultations. This needs investigation, beginning from assumptions about consultation registration in HMIS to Abx prescription habits.
3.  Overall, there is a high tendency to prescribe the Watch antibiotics group for pediatrics in all HFs.
:::

## Observations:

::: incremental
4.  The ratio of antipyretic/analgesics to antibiotics is unexpected, this is especially true for Under 5 Years patients.
:::

## Recommendations:

::: incremental
1.  Investigate the practices for the HFs with higher ratio AB courses/consultations: reporting/inventory related issues could impact the analysis, and treatment duration.

2.  Emphasize on the importance of respecting protocols and guidelines (fight against AB resistance...).

3.  double check the registration and data entry, there is errors caused by data registry errors
:::
